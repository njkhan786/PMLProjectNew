{
    "contents" : "---\ntitle: \"PMLWriteUp\"\nauthor: \"Nasir Jamal Khan\"\ndate: \"Sunday, January 25, 2015\"\noutput: html_document\n---\n\n#Description:  \n\nUsing devices such as Jawbone Up, Nike FuelBand, and Fitbit it is now possible to collect a large amount of data about personal activity relatively inexpensively. These type of devices are part of the quantified self movement a group of enthusiasts who take measurements about themselves regularly to improve their health, to find patterns in their behavior.  \nIn this project, your goal will be to use data from accelerometers on the belt, \nforearm, arm, and dumbell of 6 participants. They were asked to perform barbell \nlifts correctly and incorrectly in 5 different ways. More information is available from \nthe website here: http://groupware.les.inf.puc-rio.br/har (see the section on the Weight Lifting Exercise Dataset).  \n\n#Objective:  \nThe goal of your project is to:  \n-  Predict the manner in which they did the exercise. \n-  Create a report describing how you built your model, how you used cross validation,  You may use variable \"classe\" or any of the other variables to predict with, how you used cross validation, what you think the expected out of sample error is, and why you made the choices you did  \n\n#Data Source:  \n\nThe training and test data for this project are available here: \n\n(https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv)\n(https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv)\n\nThe data for this project come from this source: [link](http://groupware.les.inf.puc-rio.br/har)  \n\n#Processing and Analysis  \n\n##Data Loading:  \nThe source training and testing datasets from above links were downloaded and loaded into respective data frame as following. \n\n```{r libraries.etc, echo=FALSE, results='hide', message=FALSE}\ncachepkgs = TRUE\n```\n\n```{r pkgs.loading.chunk1, cache = cachepkgs, echo=FALSE, warning=FALSE, message=FALSE}\n# Install packages\nlibrary(AppliedPredictiveModeling)\nlibrary(ggplot2)\nlibrary(lattice)\nlibrary(caret)\nlibrary(rattle)\n#install.packages('rpart.plot')\n#library(rpart.plot)\nlibrary(randomForest)\n# load data\ntraining<-read.csv('I:/Coursera/PMLearning/Project/pml-training.csv',na.strings=c(\"NA\",\"#DIV/0!\",\"\"),header=T)\ntesting<-read.csv('I:/Coursera/PMLearning/Project/pml-testing.csv',na.strings=c(\"NA\",\"#DIV/0!\",\"\"),header=T)\ndim(training);dim(testing)\n```\n\n##Data Cleaning:  \nThe both datasets have identical 160 variables. There is a high number of variables which are either irrelevent or not valid i.e. high percent of values such as **NA**. Also the first seven variables are removed as those are not revelent for preparing the predicting model.  \n\n```{r cache=TRUE}\nset.seed(78662)     # A random seed number which will be used throughout this project  \n\ntrainingCols <- colnames(training)\nCountbyColumns <- as.vector(apply(training, 2, \n                            function(training) length(which(!is.na(training)))))\nVar4removal <- c()\nfor (cnt in 1:length(CountbyColumns)) {\n    if (CountbyColumns[cnt] < nrow(training)) {\n        Var4removal <- c(Var4removal, trainingCols[cnt])\n    }\n}\nCleantraining <- training[,!(names(training) %in% Var4removal)]\nCleantraining <- Cleantraining[,8:length(colnames(Cleantraining))]\n#\nCleantesting <- testing[,!(names(testing) %in% Var4removal)]\ntesting <- Cleantesting[,8:length(colnames(Cleantesting))]\ndim(Cleantraining); dim(testing)\n```\n\n##Partitioning of Training Data for processing and cross validating:  \n\n```{r cache=TRUE}\ninTrain <- createDataPartition(y=Cleantraining$classe, p=0.6, list=FALSE)\nnewtraining <- Cleantraining[inTrain, ]; validation <- Cleantraining[-inTrain, ]\ndim(newtraining); dim(validation)\n``` \n\n## Model fitting using rpart:\n```{r cache=TRUE}\nset.seed(78662)\nlibrary(rpart.plot)\ntree1 <- rpart(validation$classe ~ ., data = validation)\nplot(tree1,main=\"Recursive partitioning\")\ntext(tree1)\ntreeValidation <- predict(tree1, validation, type = \"class\")\nqplot(treeValidation,classe,data=validation, main=\"Predicted Vs Actual Classe\")\nCMat<-confusionMatrix(treeValidation, validation$classe)\nctable <- as.table(matrix(c(CMat$table), nrow = 5, byrow = TRUE)) \n#plot(ctable)\nplot(ctable, type = \"barplot\",main=\"Confusion Matix\")\nprint(CMat)\n```\n\n#Result:  \nBased on the above following results from predicted model and confusion matrix data we conclude that this model is not accurate and fit enough for testing against **testing** dataset.\n\n- Accuracy : 0.7452\n- 95% CI : (0.7354, 0.7548)\n- Kappa : 0.676  \n\n## Model fitting using randomForest method and preparing prediction data: \n```{r cache=TRUE}\nset.seed(78662)\nmodelFit <- randomForest(classe ~. , data=newtraining)\npredValidation <- predict(modelFit, validation, type = \"class\")\nqplot(predValidation,classe,data=validation,main=\"Predicted Vs Actual Classe\")\nprint(modelFit)\nCMat<-confusionMatrix(predValidation, validation$classe)\nctable <- as.table(matrix(c(CMat$table), nrow = 5, byrow = TRUE)) \nplot(ctable, type = \"barplot\", main=\"Confusion Matrix\")\nprint(CMat)\n\n```\n\n#Result:  \nBased on following result from predicted model and confusion matrix data we conclude that this model is highly accurate and fit for testing against **testing** dataset.\n\n- OOB estimate of  error rate: 0.72%\n- Accuracy : 0.9943\n- 95% CI : (0.9923, 0.9958)\n- Kappa : 0.9927\n\n## Preparing files for submitting for test:  \nThe prediction model was tested against the testing dataset and using the new prediction model 20 new files were created which were all correct. The following chunck shows the  commented out r codes to produce those files so that it does not produce those files again.  \n\n```{r cache=TRUE}\nset.seed(78662)\n# predtest <- predict(modelFit, testing, type = \"class\")\n# pml_write_files = function(x){\n#   n = length(x)\n#   for(i in 1:n){\n#     filename = paste0(\"problem_id_\",i,\".txt\")\n#     write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)\n#   }\n# }\n# \n# pml_write_files(predtest)\n```",
    "created" : 1422224021165.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "3518201562",
    "id" : "BE157074",
    "lastKnownWriteTime" : 1422224179,
    "path" : "I:/Coursera/PMLearning/PMLWriteUp/Index.Rmd",
    "project_path" : "Index.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}